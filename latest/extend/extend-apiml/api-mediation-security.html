<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Zowe API Mediation Layer Security | Zowe Docs</title>
    <meta name="description" content="Home of Zowe documentation">
    <meta name="google-site-verification" content="FFi0biHTX9XKglMxt3n2NZkB-knrnPxIrgBXpIZqlzc">
    
    <link rel="preload" href="/docs-site/latest/assets/css/styles.1134dcb4.css" as="style"><link rel="preload" href="/docs-site/latest/assets/js/app.1134dcb4.js" as="script"><link rel="preload" href="/docs-site/latest/assets/js/18.1b8537c7.js" as="script"><link rel="prefetch" href="/docs-site/latest/assets/js/29.a24bd4f1.js"><link rel="prefetch" href="/docs-site/latest/assets/css/1.styles.ce13d677.css"><link rel="prefetch" href="/docs-site/latest/assets/js/1.ce13d677.js"><link rel="prefetch" href="/docs-site/latest/assets/css/2.styles.c845e006.css"><link rel="prefetch" href="/docs-site/latest/assets/js/2.c845e006.js"><link rel="prefetch" href="/docs-site/latest/assets/js/3.9a9ae748.js"><link rel="prefetch" href="/docs-site/latest/assets/js/4.e7547a09.js"><link rel="prefetch" href="/docs-site/latest/assets/js/5.816e60b6.js"><link rel="prefetch" href="/docs-site/latest/assets/js/6.f027705b.js"><link rel="prefetch" href="/docs-site/latest/assets/js/7.414b7e14.js"><link rel="prefetch" href="/docs-site/latest/assets/js/8.9ff196f8.js"><link rel="prefetch" href="/docs-site/latest/assets/js/9.b2855836.js"><link rel="prefetch" href="/docs-site/latest/assets/js/10.a5a7cb89.js"><link rel="prefetch" href="/docs-site/latest/assets/js/11.a3855e84.js"><link rel="prefetch" href="/docs-site/latest/assets/js/12.cd8d92df.js"><link rel="prefetch" href="/docs-site/latest/assets/js/13.0f5ea69b.js"><link rel="prefetch" href="/docs-site/latest/assets/js/14.8f029eeb.js"><link rel="prefetch" href="/docs-site/latest/assets/js/15.87b8917e.js"><link rel="prefetch" href="/docs-site/latest/assets/js/16.333e60a3.js"><link rel="prefetch" href="/docs-site/latest/assets/js/17.b1b10f1f.js"><link rel="prefetch" href="/docs-site/latest/assets/js/19.73e5fc43.js"><link rel="prefetch" href="/docs-site/latest/assets/js/20.6e1df863.js"><link rel="prefetch" href="/docs-site/latest/assets/js/21.84b81801.js"><link rel="prefetch" href="/docs-site/latest/assets/js/22.3ac17c57.js"><link rel="prefetch" href="/docs-site/latest/assets/js/23.4235a406.js"><link rel="prefetch" href="/docs-site/latest/assets/js/24.4ba46d6d.js"><link rel="prefetch" href="/docs-site/latest/assets/js/25.36927b42.js"><link rel="prefetch" href="/docs-site/latest/assets/js/26.b6eee2aa.js"><link rel="prefetch" href="/docs-site/latest/assets/js/27.b3f615cf.js"><link rel="prefetch" href="/docs-site/latest/assets/js/28.d2899411.js"><link rel="prefetch" href="/docs-site/latest/assets/js/30.3d5a6bf5.js"><link rel="prefetch" href="/docs-site/latest/assets/js/31.209f6d3d.js"><link rel="prefetch" href="/docs-site/latest/assets/js/32.d7aa0d28.js"><link rel="prefetch" href="/docs-site/latest/assets/js/33.850ff8c5.js"><link rel="prefetch" href="/docs-site/latest/assets/js/34.3be03985.js"><link rel="prefetch" href="/docs-site/latest/assets/js/35.577b8d53.js"><link rel="prefetch" href="/docs-site/latest/assets/js/36.1098997c.js"><link rel="prefetch" href="/docs-site/latest/assets/js/37.8016726a.js"><link rel="prefetch" href="/docs-site/latest/assets/js/38.801c0912.js"><link rel="prefetch" href="/docs-site/latest/assets/js/39.ad66b4b9.js"><link rel="prefetch" href="/docs-site/latest/assets/js/40.c3316bac.js"><link rel="prefetch" href="/docs-site/latest/assets/js/41.efe6ad9a.js"><link rel="prefetch" href="/docs-site/latest/assets/js/42.45a16cba.js"><link rel="prefetch" href="/docs-site/latest/assets/js/43.ac90da8c.js"><link rel="prefetch" href="/docs-site/latest/assets/js/44.5f1391cb.js"><link rel="prefetch" href="/docs-site/latest/assets/js/45.2701078b.js"><link rel="prefetch" href="/docs-site/latest/assets/js/46.009b036b.js"><link rel="prefetch" href="/docs-site/latest/assets/js/47.e3d93417.js"><link rel="prefetch" href="/docs-site/latest/assets/js/48.5adb27ff.js"><link rel="prefetch" href="/docs-site/latest/assets/js/49.15605966.js"><link rel="prefetch" href="/docs-site/latest/assets/js/50.fd31fabf.js"><link rel="prefetch" href="/docs-site/latest/assets/js/51.c94ef792.js"><link rel="prefetch" href="/docs-site/latest/assets/js/52.183399bd.js"><link rel="prefetch" href="/docs-site/latest/assets/js/53.9257f3ab.js"><link rel="prefetch" href="/docs-site/latest/assets/js/54.b89fcebc.js"><link rel="prefetch" href="/docs-site/latest/assets/js/55.eb888439.js"><link rel="prefetch" href="/docs-site/latest/assets/js/56.875f2d13.js"><link rel="prefetch" href="/docs-site/latest/assets/js/57.1c6c53a9.js"><link rel="prefetch" href="/docs-site/latest/assets/js/58.11711654.js"><link rel="prefetch" href="/docs-site/latest/assets/js/59.b2435931.js"><link rel="prefetch" href="/docs-site/latest/assets/js/60.60bcf4b6.js"><link rel="prefetch" href="/docs-site/latest/assets/js/61.870e6d76.js"><link rel="prefetch" href="/docs-site/latest/assets/js/62.5ed6a3eb.js"><link rel="prefetch" href="/docs-site/latest/assets/js/63.cfb3c618.js"><link rel="prefetch" href="/docs-site/latest/assets/js/64.4a271364.js"><link rel="prefetch" href="/docs-site/latest/assets/js/65.497b4f25.js"><link rel="prefetch" href="/docs-site/latest/assets/js/66.7170c3fa.js"><link rel="prefetch" href="/docs-site/latest/assets/js/67.5efd0086.js"><link rel="prefetch" href="/docs-site/latest/assets/js/68.2926130c.js"><link rel="prefetch" href="/docs-site/latest/assets/js/69.6ee639f5.js"><link rel="prefetch" href="/docs-site/latest/assets/js/70.bcb7c295.js"><link rel="prefetch" href="/docs-site/latest/assets/js/71.fdc0cff3.js"><link rel="prefetch" href="/docs-site/latest/assets/js/72.d81edc5a.js"><link rel="prefetch" href="/docs-site/latest/assets/js/73.ae8f567f.js"><link rel="prefetch" href="/docs-site/latest/assets/js/74.706e4527.js"><link rel="prefetch" href="/docs-site/latest/assets/js/75.7e36da37.js"><link rel="prefetch" href="/docs-site/latest/assets/js/76.c2717584.js"><link rel="prefetch" href="/docs-site/latest/assets/js/77.24860a69.js"><link rel="prefetch" href="/docs-site/latest/assets/css/78.styles.df4c2b7e.css"><link rel="prefetch" href="/docs-site/latest/assets/js/vendors~docsearch.df4c2b7e.js">
    <link rel="stylesheet" href="/docs-site/latest/assets/css/styles.1134dcb4.css"><link rel="stylesheet" href="/docs-site/latest/assets/css/1.styles.ce13d677.css"><link rel="stylesheet" href="/docs-site/latest/assets/css/2.styles.c845e006.css"><link rel="stylesheet" href="/docs-site/latest/assets/css/78.styles.df4c2b7e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs-site/latest/" class="home-link router-link-active"><!----> <span class="site-name">
      Zowe Docs
    </span></a> <div class="links"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-site/latest/getting-started/overview.html" class="nav-link">Zowe overview</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/getting-started/summaryofchanges.html" class="nav-link">Release notes</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">User Guide</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-site/latest/user-guide/installandconfig.html" class="nav-link">Installing Zowe</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/user-guide/mvd-configuration.html" class="nav-link">Configuring Zowe</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/user-guide/using.html" class="nav-link">Using Zowe</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/user-guide/cli-extending.html" class="nav-link">Zowe CLI extensions and plug-ins</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Extending</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-site/latest/extend/extend-api/libertyAPI.html" class="nav-link">Developing JEE components</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/extend/extend-apiml/api-mediation-onboard-overview.html" class="nav-link">Developing for API Mediation Layer</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/extend/extend-cli/cli-devTutorials.html" class="nav-link">Developing for Zowe CLI</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/extend/extend-desktop/mvd-extendingzlux.html" class="nav-link">Developing for Zowe Application Framework</a></li></ul></div></div><div class="nav-item"><a href="/docs-site/latest/troubleshoot/troubleshootinstall.html" class="nav-link">Troubleshooting</a></div><div class="nav-item"><a href="/docs-site/latest/contribute/contribute-doc.html" class="nav-link">Contributing</a></div><div class="nav-item"><a href="https://zowe.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Zowe.org
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/zowe/docs-site" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-site/latest/getting-started/overview.html" class="nav-link">Zowe overview</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/getting-started/summaryofchanges.html" class="nav-link">Release notes</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">User Guide</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-site/latest/user-guide/installandconfig.html" class="nav-link">Installing Zowe</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/user-guide/mvd-configuration.html" class="nav-link">Configuring Zowe</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/user-guide/using.html" class="nav-link">Using Zowe</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/user-guide/cli-extending.html" class="nav-link">Zowe CLI extensions and plug-ins</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Extending</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs-site/latest/extend/extend-api/libertyAPI.html" class="nav-link">Developing JEE components</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/extend/extend-apiml/api-mediation-onboard-overview.html" class="nav-link">Developing for API Mediation Layer</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/extend/extend-cli/cli-devTutorials.html" class="nav-link">Developing for Zowe CLI</a></li><li class="dropdown-item"><!----> <a href="/docs-site/latest/extend/extend-desktop/mvd-extendingzlux.html" class="nav-link">Developing for Zowe Application Framework</a></li></ul></div></div><div class="nav-item"><a href="/docs-site/latest/troubleshoot/troubleshootinstall.html" class="nav-link">Troubleshooting</a></div><div class="nav-item"><a href="/docs-site/latest/contribute/contribute-doc.html" class="nav-link">Contributing</a></div><div class="nav-item"><a href="https://zowe.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Zowe.org
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/zowe/docs-site" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>Developing JEE components</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/docs-site/latest/extend/extend-api/libertyAPI.html" class="sidebar-link">Creating a RestAPI with Swagger documentation using Liberty</a></li><li><a href="/docs-site/latest/extend/extend-api/liberty-api-sample.html" class="sidebar-link">Provide Liberty API Sample</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Developing for API Mediation Layer</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Developing for Zowe CLI</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Developing for Zowe Application Framework</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"><div class="page-edit"><div class="header-title"><h1>Zowe API Mediation Layer Security</h1></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">11/22/2018, 5:18:51 PM</span></div> <div class="edit-link"><a href="https://github.com/zowe/docs-site/edit/master/docs/extend/extend-apiml/api-mediation-security.md" target="_blank" rel="noopener noreferrer">Propose content change in GitHub.</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="header-underline"></div></div> <div class="content"><h1 id="zowe-api-mediation-layer-security"><a href="#zowe-api-mediation-layer-security" aria-hidden="true" class="header-anchor">#</a> Zowe API Mediation Layer Security</h1> <ol><li><a href="#introduction-and-requirements">Introduction and requirements</a> <ol><li><a href="#transport-level-security">Transport-level Security</a></li> <li><a href="#authentication">Authentication</a></li> <li><a href="#authorization">Authorization</a></li> <li><a href="#types-of-services">Types of services</a></li> <li><a href="#transport-security-requirements">Transport Security Requirements</a></li> <li><a href="#authentication-1">Authentication</a></li> <li><a href="#trust-stores-and-key-stores">Trust stores and key stores</a></li></ol></li> <li><a href="#client-certificates">Client Certificates</a></li> <li><a href="#certificate-management-in-zowe-api-mediation-layer">Certificate Management in Zowe API Mediation Layer</a></li> <li><a href="#running-on-localhost">Running on localhost</a> <ol><li><a href="#how-to-start-apiml-on-localhost-with-full-https">How to start APIML on localhost with full HTTPS</a></li> <li><a href="#certificate-management-script">Certificate management script</a></li> <li><a href="#generating-own-certificates-for-localhost">Generating own certificates for localhost</a></li> <li><a href="#generating-certificate-for-a-new-service-on-localhost">Generating certificate for a new service on localhost</a></li> <li><a href="#add-a-service-with-an-existing-certificate-to-apiml-on-localhost">Add a service with an existing certificate to APIML on localhost</a></li> <li><a href="#zowe-runtime-on-zos">Zowe runtime on z/OS</a></li> <li><a href="#certificates-for-zos-installation-from-the-zowe-pax-file">Certificates for z/OS installation from the Zowe PAX file</a></li> <li><a href="#generating-certificate-for-a-new-service-on-localhost-1">Generating certificate for a new service on localhost</a></li> <li><a href="#add-a-service-with-an-existing-certificate-to-apiml-on-localhost-1">Add a service with an existing certificate to APIML on localhost</a></li></ol></li></ol> <h2 id="introduction-and-requirements"><a href="#introduction-and-requirements" aria-hidden="true" class="header-anchor">#</a> Introduction and requirements</h2> <p>The security of the APIML is done on several levels. They are described in following sections.</p> <h3 id="transport-level-security"><a href="#transport-level-security" aria-hidden="true" class="header-anchor">#</a> Transport-level Security</h3> <p>The data need to be secured during transport this is achieved by using TLS protocol for all connections to APIML services. While it is allowed to disable it (e.g. for debugging purposes), the default mode is to have in on.</p> <h3 id="authentication"><a href="#authentication" aria-hidden="true" class="header-anchor">#</a> Authentication</h3> <p>Authentication is a way how an entity - a user or an application (API Client or API Service) can prove that they are what they claim to be.</p> <p>The APIML is using to authentication methods:</p> <ul><li>user ID and password (and authentication tokes retrieved by using user ID and password)
<ul><li>requests originate from a user</li> <li>user ID and password are validated by z/OS security manager and then the token is used to access the API service</li></ul></li> <li>TLS client certificates - for service-only requests</li></ul> <p>In the future, we would like APIML to support client certificates to access the gateway.</p> <h3 id="authorization"><a href="#authorization" aria-hidden="true" class="header-anchor">#</a> Authorization</h3> <p>Authorization is a method how access rights of an entity are determined.</p> <p>In the APIML, the authorization is done by z/OS security manager (<a href="https://www.ca.com/us/products/ca-acf2.html" target="_blank" rel="noopener noreferrer">CA ACF2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://www.ibm.com/support/knowledgecenter/zosbasics/com.ibm.zos.zsecurity/zsecc_042.htm" target="_blank" rel="noopener noreferrer">IBM RACF<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://www.ca.com/us/products/ca-top-secret.html" target="_blank" rel="noopener noreferrer">CA Top Secret<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>). The authentication token is used as a proof of a valid authentication but authorization checks are always done by the z/OS security manager.</p> <h3 id="types-of-services"><a href="#types-of-services" aria-hidden="true" class="header-anchor">#</a> Types of services</h3> <ul><li><p>Zowe Core services:</p> <ul><li><p>Zowe APIML services:</p> <ul><li><p>Gateway Service (GW)</p> <ul><li>The gateway is the access point for API clients that need to access API services</li> <li>API Services can be accessed via the gateway by API Clients</li> <li>Gateway gets information about API Service from Discovery Service</li></ul></li> <li><p>Discovery Service (DS)</p> <ul><li>The discovery service collects information about API Services and provides it to GW and other services</li> <li>API Mediation services are registered to it too</li></ul></li> <li><p>API Catalog (AC)</p> <ul><li>Displays information about API services in a web UI</li> <li>Gets information about API Service from Discovery Service</li></ul></li> <li><p>Authentication and Authorization Service (AAS)</p> <ul><li>Provides authentication and authorization functionality to check access of users to resources on z/OS</li> <li>Security service is not provided as an individual microservice but is included to the Gateway Service</li> <li>More details are on in <a href="https://github.com/gizafoundation/api-layer/wiki/Zowe-Authentication-and-Authorization-Service" target="_blank" rel="noopener noreferrer">APIML wiki<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></li> <li><p>Non-APIML Zowe Core services (zLUX, Atlas)</p> <ul><li>They are like other regular API Client and Service described below</li></ul></li></ul></li> <li><p>API Clients</p> <ul><li>API Clients are external applications, users, or other API services that are accessing the API services via the GW</li></ul></li> <li><p>API Services</p> <ul><li>API Services are applications that want to be accessed via the gateway</li> <li>They register themselves to the DS</li> <li>API Services can always access other services via GW</li> <li>API Services can sometimes access other services without GW (in case that they are installed in such way that direct access is possible)</li> <li>API Services can be API Clients to (when they access other services)</li></ul></li></ul> <p>Following diagram show basic relationships between services:
<img src="/docs-site/latest/assets/img/apiml-components.dc19f00d.svg" alt="Services Diagram"></p> <h3 id="transport-security-requirements"><a href="#transport-security-requirements" aria-hidden="true" class="header-anchor">#</a> Transport Security Requirements</h3> <p>All the servers need to provide HTTPS ports.</p> <p>The requirements for the services are following:</p> <ul><li><p>API Client</p> <ul><li>Is not a server</li> <li>Needs to trust GW</li> <li>Has a trust store that contains certificate(s) needed to trust GW</li></ul></li> <li><p>Gateway Service</p> <ul><li>Provides HTTPS port</li> <li>Has a key store with the server certificate
<ul><li>The certificate needs to be trusted by API Clients</li> <li>This certificate should be trusted by web browsers because GW be used to display web UIs</li></ul></li> <li>Has a trust store that contains certificates needed to trust API Services</li></ul></li> <li><p>API Catalog</p> <ul><li>Provides HTTPS port</li> <li>Has a key store with the server certificate
<ul><li>The certificate needs to be trusted by GW</li> <li>This certificate does not need to be trusted by anyone else</li></ul></li></ul></li> <li><p>Discovery Service</p> <ul><li>Provides HTTPS port</li> <li>Has a key store with the server certificate
<ul><li>The certificate needs to be trusted by API Clients</li></ul></li> <li>Has a trust store that contains certificates needed to trust API Services</li></ul></li> <li><p>API Service</p> <ul><li>Provides HTTPS port</li> <li>Has a key store with the server and client certificate
<ul><li>The server certificate needs to be trusted by GW</li> <li>The client certificate needs to be trusted by DS</li> <li>The client and server certificates can be the same</li> <li>These certificates do not need to be trusted by anyone else</li></ul></li> <li>Has a trust store that contains certificate(s) needed to trust GW and DS</li></ul></li></ul> <h3 id="authentication-2"><a href="#authentication-2" aria-hidden="true" class="header-anchor">#</a> Authentication</h3> <ul><li><p>API Gateway</p> <ul><li>API gateway does not handle authentication right now - requests are sent to the API services who need to handle authentication</li></ul></li> <li><p>API Catalog</p> <ul><li>API catalog is accessed by users and it needs to be protected by a login</li> <li>This is done via Authentication and Authorization Service</li></ul></li> <li><p>Discovery Service</p> <ul><li>DS is accessed by API Services</li> <li>This access (reading information and registration) needs to be protected by client certificate</li> <li>Access can be allowed to users (administrators) - optional</li></ul></li> <li><p>API Services</p> <ul><li>It is up to the service</li> <li>It should be using Authentication and Authorization Service for authentication</li></ul></li></ul> <h3 id="trust-stores-and-key-stores"><a href="#trust-stores-and-key-stores" aria-hidden="true" class="header-anchor">#</a> Trust stores and key stores</h3> <p>A <em>key store</em> is a repository of security certificates - either authorization certificates or public key certificates - plus corresponding private keys, used in TLS encryption. It can be stored in Java specific format (JKS) or use the standard format (PKCS12). The Zowe APIML is using PKCS12 so the key stores can be used
by other technologies used in Zowe (Node.js).</p> <p>The APIML local CA:</p> <ul><li>Contains local CA certificate and its private key (needs to be store securely)</li> <li>It is used to sign certificates of services</li> <li>Its certificate is trusted by API services and clients</li></ul> <p>The APIML key store:</p> <ul><li>server certificate of GW (with PK) - can be signed by local CA or external CA</li> <li>server certificate of DS (with PK) - can be signed by local CA</li> <li>server certificate of AC (with PK) - can be signed by local CA</li> <li>used by APIML services</li></ul> <p>The APIML trust store:</p> <ul><li>contains local CA public certificate</li> <li>contains external CA public certificate (optional)</li> <li>can contain self-signed certificates of API Services that are not signed by local or external CA</li> <li>used by APIML services</li></ul> <p>Zowe Core services:</p> <ul><li>they can use the same key store and trust store as APIML for simpler installation and management</li> <li>or they can have individual stores for higher security</li></ul> <p>API service key store (for each service)</p> <ul><li>contains server and client certificate signed by local CA</li></ul> <p>API service trust store (for each service)</p> <ul><li>contains local CA and external CA certificates (optional)</li></ul> <h2 id="client-certificates"><a href="#client-certificates" aria-hidden="true" class="header-anchor">#</a> Client Certificates</h2> <p>A client certificate is a certificate that is used for validation of the HTTPS client.</p> <p>The client certificate of a Eureka client can be the same certificate as the server certificate of the services which the Eureka client.</p> <h2 id="certificate-management-in-zowe-api-mediation-layer"><a href="#certificate-management-in-zowe-api-mediation-layer" aria-hidden="true" class="header-anchor">#</a> Certificate Management in Zowe API Mediation Layer</h2> <h2 id="running-on-localhost"><a href="#running-on-localhost" aria-hidden="true" class="header-anchor">#</a> Running on localhost</h2> <h3 id="how-to-start-apiml-on-localhost-with-full-https"><a href="#how-to-start-apiml-on-localhost-with-full-https" aria-hidden="true" class="header-anchor">#</a> How to start APIML on localhost with full HTTPS</h3> <p>The https://github.com/zowe/api-layer repository already contains pre-generated certificates that can be used to start APIML with HTTPS on your computer. The certificates are not trusted by your browser so can either ignore security warning or generate your own certificates and add them to the trust store of your browser or system.</p> <p>The certificates are described in more detail in the https://github.com/zowe/api-layer/blob/https-local-certmgmt-%2372/keystore/README.md.</p> <h3 id="certificate-management-script"><a href="#certificate-management-script" aria-hidden="true" class="header-anchor">#</a> Certificate management script</h3> <p>Zowe API Mediation layer provides a script that can used on Windows, Mac, Linux, and z/OS
to generate the certificate and key store for the local CA, API Mediation Layer, and services.</p> <p>It is stored in [scripts/apiml_cm.sh](https://github.com/zowe/api-layer/blob/master/scripts/apiml_cm.sh.
It is a UNIX shell script that can be executed by Bash or z/OS Shell. For Windows, you need to install Bash, for example by using <a href="http://cmder.net/" target="_blank" rel="noopener noreferrer">cmder<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="generating-own-certificates-for-localhost"><a href="#generating-own-certificates-for-localhost" aria-hidden="true" class="header-anchor">#</a> Generating own certificates for localhost</h3> <p>Use the following script in the root of the <code>api-layer</code> repository:</p> <pre><code>scripts/apiml_cm.sh --action setup
</code></pre> <p>This creates the certificates and key store for the API Mediation Layer in your current workspace.</p> <h3 id="generating-certificate-for-a-new-service-on-localhost"><a href="#generating-certificate-for-a-new-service-on-localhost" aria-hidden="true" class="header-anchor">#</a> Generating certificate for a new service on localhost</h3> <p>The instructions are described at:
https://github.com/zowe/api-layer/blob/master/keystore/README.md#generating-certificate-for-a-new-service-on-localhost</p> <h3 id="add-a-service-with-an-existing-certificate-to-apiml-on-localhost"><a href="#add-a-service-with-an-existing-certificate-to-apiml-on-localhost" aria-hidden="true" class="header-anchor">#</a> Add a service with an existing certificate to APIML on localhost</h3> <p>This will be documented during work on the following user story: https://waffle.io/zowe/api-layer/cards/5bd8be80283e09001babbf86</p> <h3 id="zowe-runtime-on-z-os"><a href="#zowe-runtime-on-z-os" aria-hidden="true" class="header-anchor">#</a> Zowe runtime on z/OS</h3> <h3 id="certificates-for-z-os-installation-from-the-zowe-pax-file"><a href="#certificates-for-z-os-installation-from-the-zowe-pax-file" aria-hidden="true" class="header-anchor">#</a> Certificates for z/OS installation from the Zowe PAX file</h3> <p>When you install the Zowe runtime on z/OS from the PAX file following the instructions in <a href="https://zowe.github.io/docs-site/latest/user-guide/install-zos.html" target="_blank" rel="noopener noreferrer">Installing the Zowe runtime on z/OS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, the certificates for the APIML local CA and APIML service are automatically generated.</p> <p>They are generated by the certificate management script <code>apiml_cm.sh</code> that is installed to <code>$ZOWE_ROOT_DIR/api-mediation/scripts/apiml_cm.sh</code>.</p> <p><code>$ZOWE_ROOT_DIR</code> is the directory where you installed the Zowe runtime.</p> <p>The certificates are generated to the directory <code>$ZOWE_ROOT_DIR/api-mediation/keystore</code>.</p> <p>APIML key store and trust store:</p> <ul><li><p><code>$ZOWE_ROOT_DIR/api-mediation/keystore/local/localhost.keystore.p12</code></p> <ul><li>used for the HTTPS servers</li> <li>contains the APIML server certificate signed by the local CA and private key for the server</li></ul></li> <li><p><code>$ZOWE_ROOT_DIR/api-mediation/keystore/local/localhost.truststore.p12</code></p> <ul><li>use to validate trust when communicating with the services that are registered to the APIML</li> <li>contains the root certificate of the local CA (not the server certificate)</li> <li>contains the local CA public certificate</li> <li>can contain additional certificate to trust services that are not signed by local CA</li></ul></li></ul> <p>APIML key and trust stores needs be accessible by the user ID that executes the Zowe runtime.</p> <p>Local CA:</p> <ul><li><p><code>$ZOWE_ROOT_DIR/api-mediation/keystoree/local_ca/localca.cer</code></p> <ul><li>public certificate of local CA</li></ul></li> <li><p><code>$ZOWE_ROOT_DIR/api-mediation/keystore/local_ca/localca.keystore.p12</code></p> <ul><li>private key of the local CA</li></ul></li></ul> <p>Local CA key store can be accessible only by the user that is installing and managing the Zowe runtime.</p> <h3 id="generating-certificate-for-a-new-service-on-localhost-2"><a href="#generating-certificate-for-a-new-service-on-localhost-2" aria-hidden="true" class="header-anchor">#</a> Generating certificate for a new service on localhost</h3> <p>Follow the same steps as in https://github.com/zowe/api-layer/blob/master/keystore/README.md#generating-certificate-for-a-new-service-on-localhost.</p> <p>Use the certificate management script that is store at <code>$ZOWE_ROOT_DIR/api-mediation/scripts/apiml_cm.sh</code>.</p> <h3 id="add-a-service-with-an-existing-certificate-to-apiml-on-localhost-2"><a href="#add-a-service-with-an-existing-certificate-to-apiml-on-localhost-2" aria-hidden="true" class="header-anchor">#</a> Add a service with an existing certificate to APIML on localhost</h3> <p>This will be documented during work on the following user story: https://waffle.io/zowe/api-layer/cards/5bd8be80283e09001babbf86</p></div> <!----> </div></div></div>
    <script src="/docs-site/latest/assets/js/18.1b8537c7.js" defer></script><script src="/docs-site/latest/assets/js/app.1134dcb4.js" defer></script>
  </body>
</html>
